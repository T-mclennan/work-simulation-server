(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{154:function(e,t,n){},232:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),s=n(11),o=n.n(s),c=(n(154),n(280)),i=n(58),u=n(15),l=n(65),d=n(126),h=n.n(d),p=n(127),f=n(14),b="GET_USER",j="SET_FETCHING_STATUS",m="GET_CONVERSATIONS",g="SET_MESSAGE",x="ADD_ONLINE_USER",O="REMOVE_OFFLINE_USER",v="SET_SEARCHED_USERS",y="CLEAR_SEARCHED_USERS",w="ADD_CONVERSATION",C="SET_CONVO_AS_SEEN",S="INCREMENT_UNSEEN_COUNT",I="SET_LAST_MESSAGE_READ",k="TURN_OFF_TYPING_NOTIFICATION",E="TURN_ON_TYPING_NOTIFICATION",N="SET_ACTIVE_CHAT",F="CLEAR_ON_LOGOUT",T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isFetching:!0},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case b:return t.user;case j:return Object(f.a)(Object(f.a)({},e),{},{isFetching:t.isFetching});default:return e}},U=n(95),D=function(e,t){var n=t.message,r=t.sender;if(null!==r){var a={id:n.conversationId,otherUser:r,messages:[n]};return a.latestMessageText=n.text,[a].concat(Object(U.a)(e))}return e.map((function(e){if(e.id===n.conversationId){var t=Object(f.a)({},e);return t.messages.push(n),t.latestMessageText=n.text,t}return e}))},A=function(e){return e.map((function(e){var t=e.messages,n=e.otherUser,r=t[t.length-1];return r&&r.senderId===n.id?e:Object(f.a)(Object(f.a)({},e),{},{unseenCount:0})}))},R=function(e,t){return e.map((function(e){if(e.otherUser.id===t){var n=Object(f.a)({},e);return n.otherUser.online=!0,n}return e}))},_=function(e,t){return e.map((function(e){if(e.otherUser.id===t){var n=Object(f.a)({},e);return n.otherUser.online=!1,n}return e}))},B=function(e,t){var n={};e.forEach((function(e){n[e.otherUser.id]=!0}));var r=Object(U.a)(e);return t.forEach((function(e){if(!n[e.id]){var t={otherUser:e,messages:[]};r.push(t)}})),r},L=function(e,t){return e.map((function(e){return e.id===t?Object(f.a)(Object(f.a)({},e),{},{unseenCount:0}):e}))},W=function(e,t){return e.map((function(e){if(e.id===t){var n=e.unseenCount;return Object(f.a)(Object(f.a)({},e),{},{unseenCount:n+1})}return e}))},M=function(e,t,n){return e.map((function(e){if(e.otherUser.id===t){var r=Object(f.a)({},e);return r.id=n.conversationId,r.messages.push(n),r.latestMessageText=n.text,r}return e}))},P=function(e,t){var n=t.messageId,r=t.convoId;return e.map((function(e){return e.id===r?Object(f.a)(Object(f.a)({},e),{},{lastMessageReadId:n}):e}))},z=function(e,t){return e.map((function(e){return e.id===t?Object(f.a)(Object(f.a)({},e),{},{isTyping:!0}):e}))},G=function(e,t){return e.map((function(e){return e.id===t?Object(f.a)(Object(f.a)({},e),{},{isTyping:!1}):e}))},q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case m:return A(t.conversations);case g:return D(e,t.payload);case x:return R(e,t.id);case O:return _(e,t.id);case v:return B(e,t.users);case y:return e.filter((function(e){return e.id}));case w:return M(e,t.payload.recipientId,t.payload.newMessage);case C:return L(e,t.id);case S:return W(e,t.id);case I:return P(e,t.payload);case E:return G(e,t.id);case k:return z(e,t.id);default:return e}},V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N:return t.userId;default:return e}},X=Object(l.b)({user:T,conversations:q,activeConversationUserId:V}),H=function(e,t){return t.type===F&&(e=void 0),X(e,t)},Z=[p.a,h.a],K=Object(l.d)(H,Object(l.c)(l.a.apply(void 0,Z),"undefined"===typeof window.__REDUX_DEVTOOLS_EXTENSION__?function(e){return e}:window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__())),Y=n(138),J=n(266),$=Object(Y.a)({typography:{fontFamily:"Open Sans, sans-serif",fontSize:14,button:{textTransform:"none",letterSpacing:0,fontWeight:"bold"}},overrides:{MuiInput:{input:{fontWeight:"bold"}}},palette:{primary:{main:"#3A8DFF"},secondary:{main:"#B0B0B0"}}}),Q=Object(J.a)((function(e){return{headerBox:{display:"flex",flexDirection:"row",justifyContent:"flex-end",width:"100%",alignItems:"center"},formBox:{width:60,backgroundColor:"lightgray"},accentText:{color:"rgb(189, 189, 189)"},boldStatementText:{fontWeight:"bold",fontSize:30},navButton:{width:"10rem",height:"3.5rem",marginLeft:"3rem",color:e.palette.primary.main,boxShadow:"0 2px 20px 0 rgba(88, 133, 196, 0.2)",transition:"all 0.3s linear","&:hover":{color:"rgba(148, 9, 69, 0.8)",boxShadow:"0 2px 20px 0 rgba(88, 133, 196, 0.4)"}},actionButton:{width:"10rem",height:"3.5rem",backgroundColor:"#3A8DFF",color:"white",transition:"all 0.2s linear",fontSize:16,fontWeight:"bold",boxShadow:"0 2px 20px 0 rgba(88, 133, 196, 0.2)","&:hover":{backgroundColor:"rgba(148, 9, 69, 0.8)",boxShadow:"0 2px 20px 0 rgba(88, 133, 196, 0.4)"}},pageContainer:{height:"100%",padding:35,display:"flex",flexDirection:"column",justifyContent:"flex-start",alignItems:"center"},contentBox:{width:"80%",maxWidth:450,display:"flex",flexDirection:"column",justifyContent:"center"},textField:{width:"100%"}}}),{index:1}),ee=n(45),te=n(18),ne=n(7),re=n.n(ne),ae=n(13),se=n(33),oe=n.n(se),ce=n(132),ie=n.n(ce),ue=function(e,t){return{type:g,payload:{message:e,sender:t||null}}},le=function(e,t){return{type:w,payload:{recipientId:e,newMessage:t}}},de=function(e){return{type:C,id:e}},he=function(e){return{type:k,id:e}},pe=function(e){return{type:E,id:e}},fe=localStorage.getItem("messenger-token"),be=ie()("http://localhost:3001");be.removeAllListeners(),be.on("connect",(function(){be.emit("authentication",{token:fe}),be.on("unauthorized",(function(e){console.log("There was an error with the authentication:",e.message)})),be.on("authenticated",(function(){be.on("add-online-user",(function(e){console.log("socket - ADD ONLINE USER: ",e),K.dispatch(function(e){return{type:x,id:e}}(e))})),be.on("remove-offline-user",(function(e){K.dispatch(function(e){return{type:O,id:e}}(e))})),be.on("user-is-typing",(function(e){var t=e.convoId,n=e.recepientId,r=e.action;n===K.getState().user.id&&K.dispatch(function(e,t){return"isTyping"===t?he(e):"stoppedTyping"===t?pe(e):void 0}(t,r))})),be.on("new-message",(function(e){var t=e.message,n=e.sender,r=K.getState().activeConversationUserId,a=t.id,s=t.conversationId,o=t.senderId;r!==o?K.dispatch(function(e){return{type:S,id:e}}(s)):K.dispatch(Se(o,s,a)),K.dispatch(ue(t,n))})),be.on("message-seen",(function(e){var t=K.getState().user,n=e.convoId,r=e.messageId,a=e.senderId;t.id===a&&K.dispatch(function(e,t){return{type:I,payload:{messageId:e,convoId:t}}}(r,n))})),be.on("disconnect",(function(){console.log("***************  DISCONNECTED FROM SOCKET  *****************"),K.dispatch(ye())}))}))}));var je=function(e,t,n){be.emit("user-typing",{convoId:e,recepientId:t,action:n})},me=function(e,t,n){console.log("WEBSOCKET BROADCAST AS SEEN: msg:".concat(t," sender:").concat(n)),be.emit("message-seen",{convoId:e,messageId:t,senderId:n})},ge=be,xe=function(e){return{type:b,user:e}},Oe=function(e){return{type:j,isFetching:e}};oe.a.interceptors.request.use(function(){var e=Object(ae.a)(re.a.mark((function e(t){var n;return re.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,localStorage.getItem("messenger-token");case 2:return n=e.sent,t.headers["x-access-token"]=n,e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var ve,ye=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(){var t=Object(ae.a)(re.a.mark((function t(n){return re.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,oe.a.delete("/auth/logout");case 3:return t.next=5,localStorage.removeItem("messenger-token");case 5:n(xe({})),e&&ge.emit("logout",e),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.error(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()},we=function(){var e=Object(ae.a)(re.a.mark((function e(t){var n,r;return re.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,oe.a.post("/api/messages",t);case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ce=function(e,t){console.log(e),ge.emit("new-message",{message:e.message,recipientId:t.recipientId,sender:e.sender})},Se=function(e,t,n){return function(){var r=Object(ae.a)(re.a.mark((function r(a){var s;return re.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,oe.a.patch("/api/conversations/markSeen/".concat(t,"/").concat(e,"/").concat(n));case 3:if(s=r.sent,s.data){r.next=7;break}throw new Error("Server request failed.");case 7:me(t,n,e),r.next=13;break;case 10:r.prev=10,r.t0=r.catch(0),console.error(r.t0);case 13:case"end":return r.stop()}}),r,null,[[0,10]])})));return function(e){return r.apply(this,arguments)}}()},Ie=n(268),ke=n(282),Ee=n(235),Ne=n(270),Fe=n(271),Te=n(281),Ue=n(283),De=n.p+"static/media/bg-img.0c5628a9.png",Ae=["title","titleId"];function Re(){return(Re=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function _e(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function Be(e,t){var n=e.title,a=e.titleId,s=_e(e,Ae);return r.createElement("svg",Re({width:"67px",height:"67px",viewBox:"0 0 67 67",xmlnsXlink:"http://www.w3.org/1999/xlink",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":a},s),n?r.createElement("title",{id:a},n):null,ve||(ve=r.createElement("g",{id:"chat"},r.createElement("path",{d:"M57.1688 9.66977C50.8366 3.43256 42.4361 0 33.4832 0C24.5302 0 16.1298 3.43256 9.79755 9.66977C-2.44191 21.7256 -3.29187 41.0233 7.68681 54.0419C6.61019 56.1767 4.88194 58.6605 2.31788 59.9023C1.08544 60.5023 0.391302 61.8 0.603792 63.1395C0.816283 64.4791 1.86457 65.5256 3.22451 65.7349C3.86198 65.8326 4.76861 65.9302 5.87356 65.9302C8.83426 65.9302 13.1974 65.2465 17.6597 62.0791C22.632 64.7163 28.0717 66 33.469 66C42.1386 66 50.7232 62.693 57.1829 56.3302C63.5152 50.093 67 41.8186 67 33C67 24.1814 63.501 15.907 57.1688 9.66977ZM54.4631 53.6651C44.901 63.0837 30.0975 64.9535 18.453 58.214C17.688 57.7674 16.7389 57.907 16.1298 58.507C16.0731 58.5349 16.0164 58.5767 15.9739 58.6186C12.1349 61.5488 8.36678 62.1628 5.87356 62.1628L5.85939 62.1628C8.7351 60.0977 10.5483 57.0279 11.6108 54.6419C11.7808 54.2372 11.8091 53.8186 11.71 53.4279C11.6675 53.0512 11.5116 52.6744 11.2425 52.3674C0.872947 40.8279 1.41126 23.2465 12.4891 12.3349C24.0627 0.934884 42.8894 0.934884 54.4489 12.3349C66.0367 23.7349 66.0367 42.2651 54.4631 53.6651Z",transform:"translate(0 0.5)",id:"Shape",fill:"#FFFFFF",stroke:"none"}),r.createElement("path",{d:"M2.5 5C3.88071 5 5 3.88071 5 2.5C5 1.11929 3.88071 0 2.5 0C1.11929 0 0 1.11929 0 2.5C0 3.88071 1.11929 5 2.5 5Z",transform:"translate(31 31.5)",id:"Oval",fill:"#FFFFFF",stroke:"none"}),r.createElement("path",{d:"M2.5 5C3.88071 5 5 3.88071 5 2.5C5 1.11929 3.88071 0 2.5 0C1.11929 0 0 1.11929 0 2.5C0 3.88071 1.11929 5 2.5 5Z",transform:"translate(43 31.5)",id:"Oval",fill:"#FFFFFF",stroke:"none"}),r.createElement("path",{d:"M2.5 5C3.88071 5 5 3.88071 5 2.5C5 1.11929 3.88071 0 2.5 0C1.11929 0 0 1.11929 0 2.5C0 3.88071 1.11929 5 2.5 5Z",transform:"translate(19 31.5)",id:"Oval",fill:"#FFFFFF",stroke:"none"}))))}var Le=r.forwardRef(Be),We=(n.p,n(2)),Me=Object(J.a)((function(e){return{hero:{backgroundImage:"linear-gradient(rgba(33, 125, 254, 0.85), rgba(113, 172, 255, 0.85)), url(".concat(De,")"),height:"100vh",backgroundRepeat:"no-repeat",backgroundSize:"cover",backgroundPosition:"center",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",color:"#fff",padding:10,overflow:"hidden"},text:{textAlign:"center",letterSpacing:.32,fontWeight:"light",lineHeight:1.5}}}));var Pe=function(e){var t=e.children,n=Me();return Object(We.jsx)(We.Fragment,{children:Object(We.jsxs)(Ie.a,{container:!0,children:[Object(We.jsx)(Ue.a,{xsDown:!0,children:Object(We.jsx)(Ie.a,{item:!0,sm:5,children:Object(We.jsxs)(ke.a,{className:n.hero,children:[Object(We.jsx)(Le,{style:{marginBottom:"2rem"}}),Object(We.jsx)(Ee.a,{className:n.text,variant:"h5",children:"Convese with anyone"}),Object(We.jsx)(Ee.a,{className:n.text,variant:"h5",children:"with any language"})]})})}),t]})})},ze=Object(u.b)((function(e){return{user:e.user}}),(function(e){return{login:function(t){e(function(e){return function(){var t=Object(ae.a)(re.a.mark((function t(n){var r,a;return re.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,oe.a.post("/auth/login",e);case 3:return r=t.sent,a=r.data,t.next=7,localStorage.setItem("messenger-token",a.token);case 7:n(xe(a)),ge.emit("go-online",a.id),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(0),console.error(t.t0),n(xe({error:t.t0.response.data.error||"Server Error"}));case 15:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(e){return t.apply(this,arguments)}}()}(t))}}}))((function(e){var t=Object(te.g)(),n=Q(),r=e.user,a=e.login,s=function(){var e=Object(ae.a)(re.a.mark((function e(t){var n,r;return re.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=t.target.username.value,r=t.target.password.value,e.next=5,a({username:n,password:r});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.id?Object(We.jsx)(te.a,{to:"/home"}):Object(We.jsx)(Pe,{children:Object(We.jsx)(Ie.a,{item:!0,xs:12,sm:7,md:7,children:Object(We.jsxs)(ke.a,{className:n.pageContainer,children:[Object(We.jsxs)(ke.a,{className:n.headerBox,children:[Object(We.jsx)(Ee.a,{className:n.accentText,children:"Don't have an account?"}),Object(We.jsx)(Ne.a,{className:n.navButton,onClick:function(){return t.push("/register")},children:"Create Account"})]}),Object(We.jsxs)(ke.a,{className:n.contentBox,mt:8,children:[Object(We.jsx)(ke.a,{children:Object(We.jsx)(Ee.a,{className:n.boldStatementText,children:"Welcome Back!"})}),Object(We.jsx)("form",{onSubmit:s,children:Object(We.jsxs)(Ie.a,{children:[Object(We.jsx)(ke.a,{my:1,children:Object(We.jsx)(Fe.a,{margin:"normal",fullWidth:!0,required:!0,children:Object(We.jsx)(Te.a,{fullWidth:!0,label:"Username","aria-label":"username",name:"username",type:"text"})})}),Object(We.jsx)(ke.a,{my:2,children:Object(We.jsx)(Fe.a,{margin:"normal",fullWidth:!0,required:!0,children:Object(We.jsx)(Te.a,{fullWidth:!0,label:"Password","aria-label":"password",type:"password",name:"password"})})}),Object(We.jsx)(ke.a,{mt:12.75,textAlign:"center",children:Object(We.jsx)(Ne.a,{type:"submit",variant:"contained",className:n.actionButton,children:Object(We.jsx)("strong",{children:"Login"})})})]})})]})]})})})})),Ge=n(274),qe=Object(u.b)((function(e){return{user:e.user}}),(function(e){return{register:function(t){e(function(e){return function(){var t=Object(ae.a)(re.a.mark((function t(n){var r,a;return re.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,oe.a.post("/auth/register",e);case 3:return r=t.sent,a=r.data,t.next=7,localStorage.setItem("messenger-token",a.token);case 7:n(xe(a)),ge.emit("go-online",a.id),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(0),console.error(t.t0),n(xe({error:t.t0.response.data.error||"Server Error"}));case 15:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(e){return t.apply(this,arguments)}}()}(t))}}}))((function(e){var t=Q(),n=Object(te.g)(),a=e.user,s=e.register,o=Object(r.useState)({}),c=Object(ee.a)(o,2),i=c[0],u=c[1],l=function(){var e=Object(ae.a)(re.a.mark((function e(t){var n,r,a,o;return re.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),n=t.target.username.value,r=t.target.email.value,a=t.target.password.value,o=t.target.confirmPassword.value,a===o){e.next=8;break}return u({confirmPassword:"Passwords must match"}),e.abrupt("return");case 8:return e.next=10,s({username:n,email:r,password:a});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return a.id?Object(We.jsx)(te.a,{to:"/home"}):Object(We.jsx)(Pe,{children:Object(We.jsx)(Ie.a,{item:!0,xs:12,sm:7,md:7,children:Object(We.jsxs)(ke.a,{className:t.pageContainer,children:[Object(We.jsxs)(ke.a,{className:t.headerBox,children:[Object(We.jsx)(Ee.a,{className:t.accentText,children:"Already have an account?"}),Object(We.jsx)(Ne.a,{className:t.navButton,onClick:function(){return n.push("/login")},children:"Login"})]}),Object(We.jsxs)(ke.a,{className:t.contentBox,mt:8,children:[Object(We.jsx)(ke.a,{children:Object(We.jsx)(Ee.a,{className:t.boldStatementText,children:"Create an account."})}),Object(We.jsx)("form",{onSubmit:l,children:Object(We.jsxs)(Ie.a,{children:[Object(We.jsx)(ke.a,{my:1,children:Object(We.jsx)(Fe.a,{fullWidth:!0,children:Object(We.jsx)(Te.a,{fullWidth:!0,"aria-label":"username",label:"Username",name:"username",type:"text",required:!0})})}),Object(We.jsx)(ke.a,{my:1,children:Object(We.jsx)(Fe.a,{fullWidth:!0,children:Object(We.jsx)(Te.a,{fullWidth:!0,label:"E-mail address","aria-label":"e-mail address",type:"email",name:"email",required:!0})})}),Object(We.jsx)(ke.a,{my:1,children:Object(We.jsxs)(Fe.a,{error:!!i.confirmPassword,fullWidth:!0,children:[Object(We.jsx)(Te.a,{fullWidth:!0,"aria-label":"password",label:"Password",type:"password",inputProps:{minLength:6},name:"password",required:!0}),Object(We.jsx)(Ge.a,{children:i.confirmPassword})]})}),Object(We.jsx)(ke.a,{my:1,children:Object(We.jsxs)(Fe.a,{error:!!i.confirmPassword,fullWidth:!0,children:[Object(We.jsx)(Te.a,{fullWidth:!0,label:"Confirm Password","aria-label":"confirm password",type:"password",inputProps:{minLength:6},name:"confirmPassword",required:!0}),Object(We.jsx)(Ge.a,{children:i.confirmPassword})]})}),Object(We.jsx)(ke.a,{mt:5,textAlign:"center",children:Object(We.jsx)(Ne.a,{type:"submit",variant:"contained",className:t.actionButton,children:Object(We.jsx)("strong",{children:"Create"})})})]})})]})]})})})})),Ve=n(49),Xe=n(50),He=n(52),Ze=n(51),Ke=n(6),Ye=n(279),Je=n(275),$e=Object(J.a)((function(e){return{root:{display:"flex",justifyContent:"space-between",marginLeft:20,flexGrow:1,height:"100%",overflow:"auto"},username:{fontWeight:"bold",letterSpacing:-.2},previewText:{fontSize:12,color:"#9CADC8",letterSpacing:-.17},italicText:{fontStyle:"italic",fontSize:12,color:"#9CADC8",letterSpacing:-.17},notification:{height:20,width:20,backgroundColor:"#3F92FF",marginRight:20,color:"white",fontSize:10,letterSpacing:-.5,fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:10}}})),Qe=function(e){var t=$e(),n=e.conversation,r=n.latestMessageText,a=n.otherUser,s=n.unseenCount,o=n.isTyping,c=o?t.italicText:t.previewText;return Object(We.jsxs)(ke.a,{className:t.root,children:[Object(We.jsxs)(ke.a,{children:[Object(We.jsx)(Ee.a,{className:t.username,children:a.username}),Object(We.jsxs)(Ee.a,{className:c,children:[!o&&r,o&&"Typing..."]})]}),s>0&&Object(We.jsx)(ke.a,{className:t.notification,children:Object(We.jsx)(Je.a,{badgeContent:s,color:"primary",max:999})})]})},et=n(277),tt=n(284),nt=n(273),rt=n(276),at=n(286),st=n(285),ot=n(83),ct=n.n(ot),it=Object(J.a)((function(e){return{root:{display:"flex"},paper:{marginRight:e.spacing(2)},ellipsis:{color:"#95A7C4",marginRight:24,opacity:.5}}}));function ut(e){var t=it(),n=a.a.useState(!1),r=Object(ee.a)(n,2),s=r[0],o=r[1],c=a.a.useRef(null),i=function(e){c.current&&c.current.contains(e.target)||o(!1)},u=function(t){e.handleLogout(),i(t)};function l(e){"Tab"===e.key&&(e.preventDefault(),o(!1))}var d=a.a.useRef(s);return a.a.useEffect((function(){!0===d.current&&!1===s&&c.current.focus(),d.current=s}),[s]),Object(We.jsx)("div",{className:t.root,children:Object(We.jsxs)("div",{children:[Object(We.jsx)(Ne.a,{ref:c,"aria-controls":s?"menu-list-grow":void 0,"aria-haspopup":"true",onClick:function(){o((function(e){return!e}))},children:Object(We.jsx)(ct.a,{classes:{root:t.ellipsis}})}),Object(We.jsx)(rt.a,{open:s,anchorEl:c.current,role:void 0,transition:!0,disablePortal:!0,children:function(e){var t=e.TransitionProps,n=e.placement;return Object(We.jsx)(tt.a,Object(f.a)(Object(f.a)({},t),{},{style:{transformOrigin:"bottom"===n?"center top":"center bottom"},children:Object(We.jsx)(nt.a,{children:Object(We.jsx)(et.a,{onClickAway:i,children:Object(We.jsx)(st.a,{autoFocusItem:s,id:"menu-list-grow",onKeyDown:l,children:Object(We.jsx)(at.a,{onClick:u,children:"Logout"})})})})}))}})]})})}var lt=Object(J.a)((function(){return{root:{height:44,marginTop:23,marginLeft:6,display:"flex",alignItems:"center"},subContainer:{display:"flex",justifyContent:"space-between",alignItems:"center",flexGrow:1},username:{letterSpacing:-.23,fontSize:16,fontWeight:"bold",marginLeft:17}}})),dt=Object(u.b)((function(e){return{user:e.user}}))((function(e){var t=lt(),n=e.user||{};return Object(We.jsxs)(ke.a,{className:t.root,children:[Object(We.jsx)(St,{photoUrl:n.photoUrl,online:!0}),Object(We.jsxs)(ke.a,{className:t.subContainer,children:[Object(We.jsx)(Ee.a,{className:t.username,children:n.username}),Object(We.jsx)(ut,{handleLogout:e.handleLogout})]})]})})),ht=n(272),pt=n(278),ft=n(134),bt=n.n(ft),jt=function(e){Object(He.a)(n,e);var t=Object(Ze.a)(n);function n(){var e;Object(Ve.a)(this,n);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).handleSubmit=function(e){e.preventDefault()},e}return Object(Xe.a)(n,[{key:"render",value:function(){var e=this.props.classes;return Object(We.jsx)("form",{onSubmit:this.handleSubmit,children:Object(We.jsx)(Fe.a,{fullWidth:!0,hiddenLabel:!0,children:Object(We.jsx)(ht.a,{name:"search",onChange:this.props.handleChange,classes:{root:e.filledInput,input:e.input},disableUnderline:!0,placeholder:"Search",startAdornment:Object(We.jsx)(pt.a,{position:"start",children:Object(We.jsx)(bt.a,{})})})})})}}]),n}(r.Component),mt=Object(Ke.a)({filledInput:{height:50,background:"#E9EEF9",borderRadius:5,fontSize:13,fontWeight:"bold",color:"#99A9C4",letterSpacing:0,display:"flex",justifyContent:"center",marginBottom:20},input:{"&::placeholder":{color:"#ADC0DE",opacity:1}}})(jt),gt=Object(J.a)((function(){return{root:{paddingLeft:21,paddingRight:21,flexGrow:1,height:"65vh"},title:{fontSize:20,letterSpacing:-.29,fontWeight:"bold",marginTop:32,marginBottom:15},userBox:{height:"100%",overflowY:"auto"}}})),xt=Object(u.b)((function(e){return{conversations:e.conversations}}))((function(e){var t=gt(),n=e.conversations||[],r=e.handleChange,a=e.searchTerm,s=e.handleLogout;return Object(We.jsxs)(ke.a,{className:t.root,children:[Object(We.jsx)(dt,{handleLogout:s}),Object(We.jsx)(Ee.a,{className:t.title,children:"Chats"}),Object(We.jsx)(mt,{handleChange:r}),Object(We.jsx)(ke.a,{className:t.userBox,children:n.filter((function(e){return e.otherUser.username.includes(a)})).map((function(e){return Object(We.jsx)(yt,{conversation:e},e.otherUser.id)}))})]})})),Ot=Object(u.b)(null,(function(e){return{searchUsers:function(t){var n;e((n=t,function(){var e=Object(ae.a)(re.a.mark((function e(t){var r,a;return re.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,oe.a.get("/api/users/".concat(n));case 3:r=e.sent,a=r.data,t({type:v,users:a}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()))},clearSearchedUsers:function(){e({type:y})}}}))((function(e){var t=e.searchUsers,n=e.clearSearchedUsers,a=e.handleLogout,s=Object(r.useState)(""),o=Object(ee.a)(s,2),c=o[0],i=o[1],u=function(){var e=Object(ae.a)(re.a.mark((function e(r){return re.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==r.target.value){e.next=4;break}return n(),i(""),e.abrupt("return");case 4:if(!c.includes(r.target.value)){e.next=7;break}return i(r.target.value),e.abrupt("return");case 7:return e.next=9,t(r.target.value);case 9:i(r.target.value);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(We.jsx)(xt,{handleChange:u,searchTerm:c,handleLogout:a})})),vt=function(e){Object(He.a)(n,e);var t=Object(Ze.a)(n);function n(){var e;Object(Ve.a)(this,n);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).handleClick=function(){var t=Object(ae.a)(re.a.mark((function t(n,r){return re.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.props.setActiveChat(n,r);case 2:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e}return Object(Xe.a)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.classes,r=t.conversation,a=r.messages.length,s=a>0?r.messages[a-1].id:null,o=r.otherUser;return Object(We.jsxs)(ke.a,{onClick:function(){return e.handleClick(r,s)},className:n.root,children:[Object(We.jsx)(St,{photoUrl:o.photoUrl,username:o.username,online:o.online,sidebar:!0}),Object(We.jsx)(Qe,{conversation:r})]})}}]),n}(r.Component),yt=Object(u.b)((function(e){return{userId:e.user.id}}),(function(e){return{setActiveChat:function(t,n){var r,a=t.otherUser,s=t.id;s&&e(function(e,t,n){return function(){var r=Object(ae.a)(re.a.mark((function r(a){return re.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,oe.a.patch("/api/conversations/viewed/".concat(e,"/").concat(n,"/"));case 3:if(r.sent.data){r.next=7;break}throw new Error("Server request failed.");case 7:a(de(e)),me(e,t,n),r.next=14;break;case 11:r.prev=11,r.t0=r.catch(0),console.error(r.t0);case 14:case"end":return r.stop()}}),r,null,[[0,11]])})));return function(e){return r.apply(this,arguments)}}()}(s,n,a.id)),e((r=a.id,{type:N,userId:r}))}}}))(Object(Ke.a)({root:{borderRadius:8,height:80,boxShadow:"0 2px 10px 0 rgba(88,133,196,0.05)",marginBottom:10,display:"flex",alignItems:"center","&:hover":{cursor:"grab"}},badge:{paddingRight:35}})(vt)),wt=n(287),Ct=Object(J.a)((function(){return{profilePic:{height:44,width:44},badge:{height:13,width:13,borderRadius:"50%",border:"2px solid white",backgroundColor:"#D0DAE9"},online:{backgroundColor:"#1CED84"},sidebar:{marginLeft:17}}})),St=function(e){var t=Ct(),n=e.sidebar,r=e.username,a=e.photoUrl,s=e.online;return Object(We.jsx)(ke.a,{className:n?t.sidebar:"",children:Object(We.jsx)(Je.a,{classes:{badge:"".concat(t.badge," ").concat(s&&t.online)},variant:"dot",anchorOrigin:{horizontal:"right",vertical:"bottom"},overlap:"circular",children:Object(We.jsx)(wt.a,{alt:r,src:a,className:t.profilePic})})})},It=Object(J.a)((function(){return{root:{display:"flex",flexDirection:"column",alignItems:"flex-end"},date:{fontSize:11,color:"#BECCE2",fontWeight:"bold",marginBottom:5},text:{fontSize:14,color:"#91A3C0",letterSpacing:-.2,padding:8,fontWeight:"bold"},bubble:{background:"#F4F6FA",borderRadius:"10px 10px 0 10px"},smallAvatar:{height:10,width:10,marginRight:11,marginTop:6}}})),kt=function(e){var t=It(),n=e.time,r=e.text,a=e.lastMessagePhoto;return Object(We.jsxs)(ke.a,{className:t.root,children:[Object(We.jsx)(Ee.a,{className:t.date,children:n}),Object(We.jsx)(ke.a,{className:t.bubble,children:Object(We.jsx)(Ee.a,{className:t.text,children:r})}),a&&Object(We.jsx)(wt.a,{alt:"last message read",src:a,className:t.smallAvatar})]})},Et=Object(J.a)((function(){return{root:{display:"flex"},avatar:{height:30,width:30,marginRight:11,marginTop:6},usernameDate:{fontSize:11,color:"#BECCE2",fontWeight:"bold",marginBottom:5},bubble:{backgroundImage:"linear-gradient(225deg, #6CC1FF 0%, #3A8DFF 100%)",borderRadius:"0 10px 10px 10px"},text:{fontSize:14,fontWeight:"bold",color:"#FFFFFF",letterSpacing:-.2,padding:8}}})),Nt=function(e){var t=Et(),n=e.text,r=e.time,a=e.otherUser;return Object(We.jsxs)(ke.a,{className:t.root,children:[Object(We.jsx)(wt.a,{alt:a.username,src:a.photoUrl,className:t.avatar}),Object(We.jsxs)(ke.a,{children:[Object(We.jsxs)(Ee.a,{className:t.usernameDate,children:[a.username," ",r]}),Object(We.jsx)(ke.a,{className:t.bubble,children:Object(We.jsx)(Ee.a,{className:t.text,children:n})})]})]})},Ft=Object(J.a)((function(){return{root:{display:"flex",flexGrow:8,flexDirection:"column"},chatContainer:{marginLeft:41,marginRight:41,display:"flex",flexDirection:"column",flexGrow:1,justifyContent:"space-between",height:"65vh",overflow:"auto"}}})),Tt=Object(u.b)((function(e){return{user:e.user,conversations:e.conversations,activeConversationUserId:e.activeConversationUserId}}),null)((function(e){var t=Ft(),n=e.user,r=e.conversations,a=e.activeConversationUserId,s=r.find((function(e){return e.otherUser.id===a}))||{};return Object(We.jsx)(ke.a,{className:t.root,children:s.otherUser&&Object(We.jsxs)(We.Fragment,{children:[Object(We.jsx)(Rt,{username:s.otherUser.username,online:s.otherUser.online||!1}),Object(We.jsx)(ke.a,{className:t.chatContainer,children:Object(We.jsx)(Lt,{lastMessageReadId:s.lastMessageReadId,messages:s.messages,otherUser:s.otherUser,userId:n.id,typing:s.isTyping})}),Object(We.jsx)(Dt,{otherUser:s.otherUser,conversationId:s.id,user:n})]})})})),Ut=function(e){Object(He.a)(n,e);var t=Object(Ze.a)(n);function n(e){var r;return Object(Ve.a)(this,n),(r=t.call(this,e)).handleChange=function(e){r.setState({text:e.target.value})},r.handleOnBlur=function(){var e=r.props,t=e.otherUser,n=e.conversationId;je(n,t.id,"stoppedTyping")},r.handleOnFocus=function(){var e=r.props,t=e.otherUser,n=e.conversationId;je(n,t.id,"isTyping")},r.handleSubmit=function(){var e=Object(ae.a)(re.a.mark((function e(t){var n,a,s,o,c,i;return re.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=r.props,a=n.otherUser,s=n.conversationId,o=n.user,c=n.postMessage,i={text:t.target.text.value,recipientId:a.id,conversationId:s,sender:s?null:o},e.next=5,c(i);case 5:r.setState({text:""});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.state={text:""},r}return Object(Xe.a)(n,[{key:"render",value:function(){var e=this.props.classes;return Object(We.jsx)("form",{className:e.root,onSubmit:this.handleSubmit,children:Object(We.jsx)(Fe.a,{fullWidth:!0,hiddenLabel:!0,children:Object(We.jsx)(ht.a,{classes:{root:e.input},disableUnderline:!0,placeholder:"Type something...",value:this.state.text,name:"text",onChange:this.handleChange,onBlur:this.handleOnBlur,onFocus:this.handleOnFocus})})})}}]),n}(r.Component),Dt=Object(u.b)((function(e){return{user:e.user,conversations:e.conversations}}),(function(e){return{postMessage:function(t){var n;e((n=t,function(){var e=Object(ae.a)(re.a.mark((function e(t){var r,a,s;return re.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,we(n);case 3:r=e.sent,a=n.conversationId,s=n.recipientId,t(a?ue(r.message):le(s,r.message)),Ce(r,n),je(a,s,"stoppedTyping"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}()))}}}))(Object(Ke.a)({root:{justifySelf:"flex-end",marginTop:15},input:{height:70,backgroundColor:"#F4F6FA",borderRadius:8,marginBottom:20}})(Ut)),At=Object(J.a)((function(e){return{root:{display:"flex",alignItems:"center",justifyContent:"space-between",height:89,marginBottom:22,boxShadow:"0 2px 20px 0 rgba(88,133,196,0.10)"},content:{display:"flex",alignItems:"center",marginLeft:24},username:{fontSize:20,letterSpacing:-.29,fontWeight:"bold",marginRight:14},statusText:{fontSize:12,color:"#BFC9DB",letterSpacing:-.17},statusDot:{height:8,width:8,borderRadius:"50%",marginRight:5,backgroundColor:"#D0DAE9"},online:{background:"#1CED84"},ellipsis:{color:"#95A7C4",marginRight:24,opacity:.5}}})),Rt=function(e){var t=At(),n=e.username,r=e.online;return Object(We.jsxs)(ke.a,{className:t.root,children:[Object(We.jsxs)(ke.a,{className:t.content,children:[Object(We.jsx)(Ee.a,{className:t.username,children:n}),Object(We.jsx)(ke.a,{className:"".concat(t.statusDot," ").concat(t[r&&"online"])}),Object(We.jsx)(Ee.a,{className:t.statusText,children:r?"Online":"Offline"})]}),Object(We.jsx)(ct.a,{classes:{root:t.ellipsis}})]})},_t=n(135),Bt=n.n(_t),Lt=function(e){var t=e.messages,n=e.otherUser,r=e.userId,a=e.typing,s=e.lastMessageReadId;return Object(We.jsxs)(ke.a,{children:[t.map((function(e){var t=Bt()(e.createdAt).format("h:mm"),a=s===e.id?n.photoUrl:null;return e.senderId===r?Object(We.jsx)(kt,{text:e.text,time:t,lastMessagePhoto:a},e.id):Object(We.jsx)(Nt,{text:e.text,time:t,otherUser:n},e.id)})),a&&Object(We.jsx)(zt,{otherUser:n})]})},Wt=n(136),Mt=n.n(Wt),Pt=Object(J.a)((function(){return{root:{display:"flex"},avatar:{height:30,width:30,marginRight:11,marginTop:6},usernameDate:{fontSize:11,color:"#BECCE2",fontWeight:"bold",marginBottom:5},bubble:{backgroundImage:"linear-gradient(225deg, #6CC1FF 0%, #3A8DFF 100%)",borderRadius:"0 10px 10px 10px",width:80,paddingLeft:20,paddingTop:5},text:{fontSize:14,fontWeight:"bold",color:"#FFFFFF",letterSpacing:-.2,padding:8}}})),zt=function(e){var t=Pt(),n=e.otherUser;return Object(We.jsx)(ke.a,{children:Object(We.jsxs)(ke.a,{className:t.root,children:[Object(We.jsx)(wt.a,{alt:n.username,src:n.photoUrl,className:t.avatar}),Object(We.jsxs)(ke.a,{children:[Object(We.jsx)(Ee.a,{className:t.usernameDate,children:n.username}),Object(We.jsx)(ke.a,{className:t.bubble,children:Object(We.jsx)(Mt.a,{type:"ThreeDots",color:"rgba(249, 249, 249, 0.8)",height:25,width:40})})]})]})})},Gt=function(e){Object(He.a)(n,e);var t=Object(Ze.a)(n);function n(e){var r;return Object(Ve.a)(this,n),(r=t.call(this,e)).handleLogout=Object(ae.a)(re.a.mark((function e(){return re.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.props.logout(r.props.user.id);case 2:case"end":return e.stop()}}),e)}))),r.state={isLoggedIn:!1},r}return Object(Xe.a)(n,[{key:"componentDidUpdate",value:function(e){this.props.user.id!==e.user.id&&this.setState({isLoggedIn:!0})}},{key:"componentDidMount",value:function(){this.props.fetchConversations()}},{key:"render",value:function(){var e=this.props.classes;return this.props.user.id?Object(We.jsx)(We.Fragment,{children:Object(We.jsxs)(Ie.a,{container:!0,component:"main",className:e.root,children:[Object(We.jsx)(Ye.a,{}),Object(We.jsx)(Ot,{handleLogout:this.handleLogout}),Object(We.jsx)(Tt,{})]})}):this.state.isLoggedIn?Object(We.jsx)(te.a,{to:"/login"}):Object(We.jsx)(te.a,{to:"/register"})}}]),n}(r.Component),qt=Object(u.b)((function(e){return{user:e.user,conversations:e.conversations}}),(function(e){return{logout:function(t){e(ye(t)),e({type:F})},fetchConversations:function(){e(function(){var e=Object(ae.a)(re.a.mark((function e(t){var n,r;return re.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,oe.a.get("/api/conversations");case 3:n=e.sent,r=n.data,t({type:m,conversations:r}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}())}}}))(Object(Ke.a)({root:{height:"100vh"}})(Gt)),Vt=n(288),Xt=n(137),Ht=n.n(Xt),Zt=Object(J.a)((function(e){return{snackbar:{backgroundColor:"red",fontWeight:"bold"},icon:{color:"white"}}})),Kt=function(e){var t=Zt();return Object(We.jsx)(Vt.a,{open:e.snackBarOpen,onClose:function(){return e.setSnackBarOpen(!1)},message:e.errorMessage||"Sorry, an error occured. Please try again",action:Object(We.jsx)(a.a.Fragment,{children:Object(We.jsx)(Ne.a,{className:t.icon,size:"small",onClick:function(){return e.setSnackBarOpen(!1)},children:Object(We.jsx)(Ht.a,{color:"secondary"})})}),ContentProps:{classes:{root:t.snackbar}}})},Yt=Object(te.h)(Object(u.b)((function(e){return{user:e.user}}),(function(e){return{fetchUser:function(){e(function(){var e=Object(ae.a)(re.a.mark((function e(t){var n,r;return re.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(Oe(!0)),e.prev=1,e.next=4,oe.a.get("/auth/user");case 4:n=e.sent,r=n.data,t(xe(r)),r.id&&ge.emit("go-online",r.id),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.error(e.t0);case 13:return e.prev=13,t(Oe(!1)),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[1,10,13,16]])})));return function(t){return e.apply(this,arguments)}}())}}}))((function(e){var t=e.user,n=e.fetchUser,a=Object(r.useState)(""),s=Object(ee.a)(a,2),o=s[0],c=s[1],i=Object(r.useState)(!1),u=Object(ee.a)(i,2),l=u[0],d=u[1];return Object(r.useEffect)((function(){n()}),[n]),Object(r.useEffect)((function(){t.error&&("string"===typeof t.error?c(t.error):c("Internal Server Error. Please try again"),d(!0))}),[t.error]),e.user.isFetchingUser?Object(We.jsx)("div",{children:"Loading..."}):Object(We.jsxs)(We.Fragment,{children:[l&&Object(We.jsx)(Kt,{setSnackBarOpen:d,errorMessage:o,snackBarOpen:l}),Object(We.jsxs)(te.d,{children:[Object(We.jsx)(te.b,{path:"/login",component:ze}),Object(We.jsx)(te.b,{path:"/register",component:qe}),Object(We.jsx)(te.b,{exact:!0,path:"/",render:function(e){var t;return(null===(t=e.user)||void 0===t?void 0:t.id)?Object(We.jsx)(qt,{}):Object(We.jsx)(ze,{})}}),Object(We.jsx)(te.b,{path:"/home",component:qt})]})]})})));var Jt=function(){return Object(We.jsx)(u.a,{store:K,children:Object(We.jsx)(c.a,{theme:$,children:Object(We.jsx)(i.a,{children:Object(We.jsx)(Yt,{})})})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(Object(We.jsx)(Jt,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[232,1,2]]]);
//# sourceMappingURL=main.a6476055.chunk.js.map